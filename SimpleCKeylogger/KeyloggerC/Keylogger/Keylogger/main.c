#include <stdlib.h>
#include <stdio.h>
#include <time.h>
#include <string.h>

#define MAX 15
#define TEXT ".txt"

int main(void)
{

	// declara
	FILE *fp;
	long int timeInt;
	char timeStr[MAX];
	int lenOfStr;
	char *timeCat;

	timeInt = getCurrentTime();
	// converte o tempo de long int para string
	lenOfStr = sprintf(timeStr, "%ld", timeInt);
	//printf("Tempo convertido (str): %s\n", timeStr);
	//printf("Tempo convertido (tamanho): %d\n", lenOfStr);

	//concatena as strings
	timeCat = (char *)malloc(lenOfStr * sizeof(char));
	if (timeCat == NULL)
	{
		puts("Memória insuficiente");
		exit(1);
	}
	timeCat = strcat(timeStr, TEXT);
	//printf("filename: %s", timeCat);

	//file
	char c;
	fp = fopen(timeCat, "a+");
	if (fp == NULL)
	{
		puts("Error");
		system("pause");
		exit(1);
	}

	// looping infinito
	while (1) {

		// kbhit() - funcao que caso seja precionado uma tecla no pc eh retornado algo diferente de zero
		if (kbhit()) {

			// getc - pega cada caractere digitado
			c = getch();
			fprintf(fp, "%c", c);
		}
	}

	fclose(fp);
	free(timeCat);

	return 0;
}


long int getCurrentTime()
{
	time_t timeNow = time(NULL);
	// %ld format specifier is implemented for representing long integer values.
	//printf("%ld", timeNow);

	return timeNow;
}
